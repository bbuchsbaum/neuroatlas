% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_generic.R, R/reduce_atlas_vec.R
\name{reduce_atlas_vec}
\alias{reduce_atlas_vec}
\alias{reduce_atlas_vec.atlas}
\title{Reduce a NeuroVec by an Atlas to a ClusteredNeuroVec}
\usage{
reduce_atlas_vec(atlas, data_vol, mask, ...)

\method{reduce_atlas_vec}{atlas}(
  atlas,
  data_vol,
  mask,
  stat_func = mean,
  dilate = FALSE,
  radius = 4,
  maxn = 50,
  ...
)
}
\arguments{
\item{atlas}{An atlas object.}

\item{data_vol}{A \code{NeuroVec} (4D) with the data to be summarised.}

\item{mask}{A \code{NeuroVol} or \code{LogicalNeuroVol} brain mask.
Non-zero values are treated as TRUE.}

\item{...}{Additional arguments passed to methods.}

\item{stat_func}{Function used to aggregate voxel values within each parcel
(default: \code{mean}).}

\item{dilate}{Logical. If \code{TRUE}, atlas parcels are dilated into the
mask before averaging (via \code{\link{dilate_atlas}}).}

\item{radius}{Numeric dilation radius in voxels (passed to
\code{\link{dilate_atlas}}). Default: 4.}

\item{maxn}{Integer maximum neighbours for dilation (passed to
\code{\link{dilate_atlas}}). Default: 50.}
}
\value{
A \code{\link[neuroim2]{ClusteredNeuroVec}}.
}
\description{
Averages (or otherwise summarises) a 4D image within each atlas parcel,
returning a \code{\link[neuroim2]{ClusteredNeuroVec}} whose voxels share one
time-series per region.
}
\details{
The atlas volume is intersected with the brain mask so that only voxels
inside the mask contribute to each parcel average.

Cluster IDs are remapped to contiguous \code{1:K} before constructing the
\code{ClusteredNeuroVec}. This is required because the \code{[,,,t]}
accessor in \pkg{neuroim2} uses cluster IDs as direct column indices into
the internal time-series matrix.

Parcels that have no voxels inside the mask receive \code{NA} time-series
in the output.
}
\examples{
\dontrun{
atlas <- get_schaefer_atlas(parcels = "200", networks = "7")
# data_vol: a NeuroVec with matching spatial dimensions
# mask:     a brain mask NeuroVol
cvec <- reduce_atlas_vec(atlas, data_vol, mask)
ts_mat <- as.matrix(cvec)   # T x K cluster time-series
}

}
\seealso{
\code{\link{reduce_atlas}} for a tibble-based summary,
  \code{\link{dilate_atlas}} for expanding parcels into a mask.
}
