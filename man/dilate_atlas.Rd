% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dilate_parcels.R
\name{dilate_atlas}
\alias{dilate_atlas}
\title{Dilate Atlas Parcellation Boundaries}
\usage{
dilate_atlas(atlas, mask, radius = 4, maxn = 50)
}
\arguments{
\item{atlas}{An object of class "atlas" containing the parcellation to be dilated}

\item{mask}{A binary mask (NeuroVol object) specifying valid voxels for dilation.
Dilation will only occur within non-zero mask values. Typically a LogicalNeuroVol,
but can be any NeuroVol that will be converted to logical via as.logical().}

\item{radius}{Numeric. The maximum distance (in voxels) to search for neighboring
parcels when dilating. Default: 4}

\item{maxn}{Integer. Maximum number of neighboring voxels to consider when
determining parcel assignment. Default: 50}
}
\value{
A \code{ClusteredNeuroVol} object containing the dilated parcellation.
  The object maintains the original label mappings but may include additional
  voxels in existing parcels.
}
\description{
Expands the boundaries of brain atlas parcels by dilating them into adjacent
unassigned voxels within a specified mask. This is useful for filling small gaps
between parcels or extending parcels into neighboring regions.
}
\details{
The dilation process:
\itemize{
  \item Identifies unassigned voxels within the mask that are adjacent to existing parcels
  \item For each unassigned voxel, finds nearby assigned voxels within the specified radius
  \item Assigns the unassigned voxel to the nearest parcel
  \item Respects mask boundaries to prevent dilation into unwanted regions
}

The function uses a k-d tree implementation (via Rnanoflann) for efficient nearest
neighbor searches in 3D space.
}
\examples{
\dontrun{
# Load an atlas
atlas <- get_aseg_atlas()

# Create or load a brain mask
mask <- get_template_brainmask()

# Dilate the atlas within the mask
dilated <- dilate_atlas(atlas, mask, radius = 4)

# More conservative dilation with fewer neighbors
dilated_conservative <- dilate_atlas(atlas, mask, radius = 2, maxn = 20)
}

}
\references{
The algorithm uses efficient k-d tree based nearest neighbor searches for
spatial queries in 3D voxel space.
}
\seealso{
\code{\link{get_template_brainmask}} for creating appropriate masks from TemplateFlow
}
