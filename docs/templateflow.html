<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>TemplateFlow Interface Refactoring Plan &amp; Tickets • neuroatlas</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="TemplateFlow Interface Refactoring Plan &amp; Tickets"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">neuroatlas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/neuroatlas-overview.html">Getting Started with neuroatlas</a></li>
    <li><a class="dropdown-item" href="articles/working-with-templateflow.html">Working with TemplateFlow in neuroatlas</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/bbuchsbaum/neuroatlas/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TemplateFlow Interface Refactoring Plan &amp; Tickets</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/neuroatlas/blob/HEAD/templateflow.md"><code>templateflow.md</code></a></small>
    </div>

<div id="templateflow-interface-refactoring-plan--tickets" class="section level1">

<div class="section level2">
<h2 id="overall-goal">Overall Goal<a class="anchor" aria-label="anchor" href="#overall-goal"></a></h2>
<p>Create a more R-native, robust, and user-friendly interface to TemplateFlow, abstracting away <code>reticulate</code> details, enhancing caching, discoverability, and integration within <code>neuroatlas</code>.</p>
</div>
<div class="section level2">
<h2 id="id_1-architecture--core-wrapper">1. Architecture &amp; Core Wrapper<a class="anchor" aria-label="anchor" href="#id_1-architecture--core-wrapper"></a></h2>
<div class="section level3">
<h3 id="id_11-central-templateflow-s3-object">1.1. Central <code>templateflow</code> S3 Object<a class="anchor" aria-label="anchor" href="#id_11-central-templateflow-s3-object"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T1.1.1</strong>: Define S3 class <code>templateflow</code>.</label></li>
<li>
<label><input type="checkbox" checked><strong>T1.1.2</strong>: Implement constructor <code><a href="reference/create_templateflow.html">create_templateflow()</a></code>:</label>
<ul class="task-list"><li><label><input type="checkbox" checked>Initializes and stores the <code>reticulate</code> Python <code>templateflow.api</code> handle (e.g., <code>tf_api</code>).</label></li>
<li><label><input type="checkbox" checked>Establishes and stores a local cache path (e.g., using <code>tools::R_user_dir("neuroatlas", "cache", "templateflow")</code>).</label></li>
<li><label><input type="checkbox" checked>Stores user-configurable options (e.g., default template, verbosity level).</label></li>
</ul></li>
<li>
<label><input type="checkbox" checked><strong>T1.1.3</strong>: Implement <code>print.templateflow</code> S3 method:</label>
<ul class="task-list"><li><label><input type="checkbox" checked>Shows basic info: TemplateFlow library path, cache path, online status.</label></li>
<li><label><input type="checkbox" checked>Lists a few example available templates or summary of discoverability (see Section 5).</label></li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T1.1.4</strong>: Implement <code>$.templateflow</code> S3 method for dynamic, R-native access to TemplateFlow entities (e.g., <code>tf$MNI152NLin2009cAsym</code>). This should internally chain calls to the Python API.</label></li>
<li><label><input type="checkbox" checked><strong>T1.1.5</strong>: Implement <code>[[.templateflow</code> S3 method as an alternative or for programmatic access.</label></li>
<li><label><input type="checkbox" checked><strong>T1.1.6</strong>: (Optional) Implement <code>names.templateflow</code> to list available top-level attributes (e.g., template names accessible via <code>$</code>).</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_12-auto-conversion--utility-helpers">1.2. Auto-conversion &amp; Utility Helpers<a class="anchor" aria-label="anchor" href="#id_12-auto-conversion--utility-helpers"></a></h3>
<ul class="task-list"><li>
<label><input type="checkbox" checked><strong>T1.2.1</strong>: Create internal helper <code>as_neurovol(py_object_or_path)</code>:</label>
<ul class="task-list"><li><label><input type="checkbox" checked>Accepts Python Nifti object path strings, or <code>nibabel.Nifti1Image</code> objects.</label></li>
<li><label><input type="checkbox" checked>Converts to a <code><a href="https://bbuchsbaum.github.io/neuroim2/reference/NeuroVol.html" class="external-link">neuroim2::NeuroVol</a></code> object.</label></li>
<li><label><input type="checkbox" checked>Handles potential errors during conversion gracefully.</label></li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T1.2.2</strong>: Integrate <code>memoise</code> into <code>as_neurovol</code> if it involves re-reading from disk for the same path within a session, or directly into the file fetching part of <code>get_template</code>.</label></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_2-retrieval-api-high-level-helper-functions">2. Retrieval API (High-Level Helper Functions)<a class="anchor" aria-label="anchor" href="#id_2-retrieval-api-high-level-helper-functions"></a></h2>
<div class="section level3">
<h3 id="id_21-unified-get_template-function">2.1. Unified <code>get_template()</code> Function<a class="anchor" aria-label="anchor" href="#id_21-unified-get_template-function"></a></h3>
<ul class="task-list"><li>
<label><input type="checkbox" checked><strong>T2.1.1</strong>: Design and implement the primary <code><a href="reference/get_template.html">get_template()</a></code> function with a signature like: <code>get_template(space = "MNI152NLin2009cAsym", variant = "brain", modality = "T1w", resolution = 1, cohort = NULL, desc = NULL, label = NULL, atlas = NULL, suffix = NULL, extension = ".nii.gz", path_only = FALSE, use_cache = TRUE, api_handle = NULL, ...)</code></label>
<ul><li>
<code>space</code>: Template identifier (e.g., “MNI152NLin2009cAsym”).</li>
<li>
<code>variant</code>: High-level type (e.g., “brain”, “head”, “probseg”, “mask”, “dseg”). Replaces <code>desc</code> for common cases but allows <code>desc</code> for full specificity.</li>
<li>
<code>modality</code>: Image type (e.g., “T1w”, “T2w”, “dwi”). Replaces <code>suffix</code> for common cases.</li>
<li>
<code>resolution</code>: Numeric resolution in mm.</li>
<li>
<code>cohort</code>, <code>desc</code>, <code>label</code>, <code>atlas</code>, <code>suffix</code>, <code>extension</code>: Pass through to TemplateFlow for fine-grained queries.</li>
<li>
<code>path_only</code>: If <code>TRUE</code>, return file path string instead of <code>NeuroVol</code>.</li>
<li>
<code>use_cache</code>: Boolean, to enable/disable caching for this call.</li>
<li>
<code>api_handle</code>: Optionally pass an existing <code>templateflow</code> S3 object (from <code><a href="reference/create_templateflow.html">create_templateflow()</a></code>) or let it use a default/global one.</li>
<li>
<code>...</code>: Additional arguments to pass to <code>tflow$api$get()</code>.</li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T2.1.2</strong>: Internally, <code><a href="reference/get_template.html">get_template()</a></code> should construct the correct query dictionary for <code>tf_api$get()</code>.</label></li>
<li>
<label><input type="checkbox" checked><strong>T2.1.3</strong>: Implement robust validation for common parameter combinations:</label>
<ul><li>E.g., if <code>variant = "probseg"</code>, <code>label</code> (for tissue type like GM/WM/CSF) should be specifiable.</li>
<li>E.g., <code>variant = "mask"</code> typically implies <code>modality = "mask"</code> (or <code>suffix="mask"</code>).</li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T2.1.4</strong>: Ensure <code><a href="reference/get_template.html">get_template()</a></code> returns a <code>NeuroVol</code> (via <code>as_neurovol</code>) or a file path string.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_22-typed-helper-functions-as-thin-wrappers">2.2. Typed Helper Functions (as thin wrappers)<a class="anchor" aria-label="anchor" href="#id_22-typed-helper-functions-as-thin-wrappers"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T2.2.1</strong>: Refactor <code>get_template_brainmask(...)</code> to be a wrapper around <code>get_template(..., variant = "mask", modality = "mask")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.2</strong>: Refactor <code>get_template_probseg(..., label)</code> to be <code>get_template(..., variant = "probseg", label = label)</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.3</strong>: Refactor <code>get_template_gm(...)</code> to be <code>get_template(..., variant = "probseg", label = "GM")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.4</strong>: Refactor <code>get_template_wm(...)</code> to be <code>get_template(..., variant = "probseg", label = "WM")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.5</strong>: Refactor <code>get_template_csf(...)</code> to be <code>get_template(..., variant = "probseg", label = "CSF")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.6</strong>: Refactor <code>get_template_head(...)</code> to be <code>get_template(..., variant = "head", modality = "T1w")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.7</strong>: Refactor <code>get_template_schaefer(...)</code> (the TemplateFlow one) to use the new <code><a href="reference/get_template.html">get_template()</a></code> with appropriate <code>atlas</code>, <code>desc</code>, <code>suffix</code> args.</label></li>
<li><label><input type="checkbox" checked><strong>T2.2.8</strong>: Review if original <code><a href="reference/get_template.html">get_template()</a></code> needs to be kept or if its functionality is fully superseded by the new <code><a href="reference/get_template.html">get_template()</a></code>. If kept for backward compatibility, mark as deprecated.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_23-vectorized-retrieval-optional-enhancement">2.3. Vectorized Retrieval (Optional Enhancement)<a class="anchor" aria-label="anchor" href="#id_23-vectorized-retrieval-optional-enhancement"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T2.3.1</strong>: (Optional) Consider allowing vectorized arguments for <code>space</code>, <code>resolution</code>, <code>variant</code> in <code><a href="reference/get_template.html">get_template()</a></code>, returning a named list of <code>NeuroVol</code> objects or paths.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_24-typed-helper-functions-for-volumes-and-surfaces">2.4 Typed Helper Functions for Volumes and Surfaces<a class="anchor" aria-label="anchor" href="#id_24-typed-helper-functions-for-volumes-and-surfaces"></a></h3>
<ul class="task-list"><li><label><input type="checkbox"><strong>T2.4.1</strong>: Implement <code>get_volume_template(template, type, ...)</code> wrapper. (Superseded by <code>get_template</code>)</label></li>
<li><label><input type="checkbox" checked><strong>T2.4.2</strong>: Implement <code>get_surface_template(template_id, surface_type, hemi, ...)</code> wrapper.</label></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_3-caching--memoisation">3. Caching &amp; Memoisation<a class="anchor" aria-label="anchor" href="#id_3-caching--memoisation"></a></h2>
<div class="section level3">
<h3 id="id_31-cache-directory-management">3.1. Cache Directory Management<a class="anchor" aria-label="anchor" href="#id_31-cache-directory-management"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T3.1.1</strong>: Implement an internal function <code>neuroatlas_cache_dir(subdir = NULL)</code> that uses <code>tools::R_user_dir("neuroatlas", "cache")</code> and creates <code>subdir</code> if it doesn’t exist. <code>templateflow</code> cache will be in <code>neuroatlas_cache_dir("templateflow")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T3.1.2</strong>: Ensure <code>tflow$api$get()</code> downloads are directed to this cache directory. TemplateFlow’s Python library itself has caching; ensure R wrapper leverages it and R session-level memoisation is complementary.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_32-session-level-memoisation">3.2. Session-Level Memoisation<a class="anchor" aria-label="anchor" href="#id_32-session-level-memoisation"></a></h3>
<ul class="task-list"><li>
<label><input type="checkbox" checked><strong>T3.2.1</strong>: Apply <code><a href="https://memoise.r-lib.org/reference/memoise.html" class="external-link">memoise::memoise()</a></code> to the core TemplateFlow fetching operation within <code><a href="reference/get_template.html">get_template()</a></code> (or the part that calls <code>tf_api$get()</code>).</label>
<ul><li>The memoisation key should be a unique, reproducible string derived from all query parameters (name, resolution, desc, label, etc.).</li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T3.2.2</strong>: Ensure memoisation stores the <em>file path</em> of the downloaded template. Subsequent calls for the same template (that would read the file) can then use the memoised path.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_33-cache-control-functions">3.3. Cache Control Functions<a class="anchor" aria-label="anchor" href="#id_33-cache-control-functions"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T3.3.1</strong>: Implement <code><a href="reference/clear_templateflow_cache.html">clear_templateflow_cache()</a></code> to remove all files from the <code>neuroatlas_cache_dir("templateflow")</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T3.3.2</strong>: (Optional) Add <code><a href="reference/show_templateflow_cache_path.html">show_templateflow_cache_path()</a></code> function.</label></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_4-error-handling--validation">4. Error Handling &amp; Validation<a class="anchor" aria-label="anchor" href="#id_4-error-handling--validation"></a></h2>
<div class="section level3">
<h3 id="id_41-pre-emptive-checks-and-graceful-errors">4.1. Pre-emptive Checks and Graceful Errors<a class="anchor" aria-label="anchor" href="#id_41-pre-emptive-checks-and-graceful-errors"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T4.1.1</strong>: In <code><a href="reference/get_template.html">get_template()</a></code>, before calling <code>tf_api$get()</code>, use <code>tf_api$template_exists(space)</code> or similar to check if the base template exists.</label></li>
<li><label><input type="checkbox" checked><strong>T4.1.2</strong>: Validate <code>resolution</code> against available resolutions for a template (e.g., using <code>tf_api$resolutions(space)</code> if such a method exists, or by attempting a fetch and catching errors).</label></li>
<li><label><input type="checkbox" checked><strong>T4.1.3</strong>: Wrap Python calls (<code>tf_api$get()</code>, etc.) in <code>tryCatch</code> or <code>reticulate::py_capture_error</code> to convert Python exceptions into R conditions (errors or warnings).</label></li>
<li><label><input type="checkbox" checked><strong>T4.1.4</strong>: Provide user-friendly R error messages (e.g., “Template ‘XYZ’ not found.” or “Resolution ‘R’mm not available for template ’XYZ’.”) instead of raw Python tracebacks.</label></li>
</ul></div>
<div class="section level3">
<h3 id="id_42-offline-mode--cache-fallback">4.2. Offline Mode &amp; Cache Fallback<a class="anchor" aria-label="anchor" href="#id_42-offline-mode--cache-fallback"></a></h3>
<ul class="task-list"><li>
<label><input type="checkbox"><strong>T4.2.1</strong>: Detect network unavailability (e.g., if <code>tf_api$get()</code> fails due to network issues).</label>
<ul><li><em>Note: Partially handled. Python errors are caught; specific network error detection is complex. Current behavior is to error on fetch failure.</em></li>
</ul></li>
<li>
<label><input type="checkbox" checked><strong>T4.2.2</strong>: If offline and <code>use_cache = TRUE</code>, <code><a href="reference/get_template.html">get_template()</a></code> should attempt to find the requested template in the local cache first.</label>
<ul><li><em>Note: Handled by <code>memoise</code> (R-level path cache) and TemplateFlow Python’s own disk cache (<code>TEMPLATEFLOW_HOME</code>). If a path/file was previously fetched successfully, it will be served from these caches without a new network request.</em></li>
</ul></li>
<li>
<label><input type="checkbox"><strong>T4.2.3</strong>: If offline and not found in cache, issue a warning and return <code>NULL</code> or error gracefully.</label>
<ul><li><em>Note: Currently errors out if a new item cannot be fetched (e.g. due to network issues). Graceful NULL return would require more specific network error detection and possibly a new parameter to <code>get_template</code>.</em></li>
</ul></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_5-discoverability-helper-functions">5. Discoverability Helper Functions<a class="anchor" aria-label="anchor" href="#id_5-discoverability-helper-functions"></a></h2>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T5.1.1</strong>: Implement <code>tflow_spaces(pattern = NULL)</code> wrapping <code>tf_api$templates()</code>.</label></li>
<li>
<label><input type="checkbox" checked><strong>T5.1.2</strong>: Implement <code>tflow_files(space, query_args = NULL)</code>:</label>
<ul><li>A more general way to query available files/metadata for a given template <code>space</code>.</li>
<li>
<code>query_args</code> could be a list of other TemplateFlow parameters (desc, suffix, etc.) to filter results.</li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T5.1.3</strong>: Revisit <code>print.templateflow</code> (T1.1.3) to make use of these listing functions for a more informative summary.</label></li>
</ul></div>
<div class="section level2">
<h2 id="id_6-inter-package-integration">6. Inter-package Integration<a class="anchor" aria-label="anchor" href="#id_6-inter-package-integration"></a></h2>
<div class="section level3">
<h3 id="id_61-universal-template-input-in-neuroatlas">6.1. Universal Template Input in <code>neuroatlas</code>
<a class="anchor" aria-label="anchor" href="#id_61-universal-template-input-in-neuroatlas"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T6.1.1</strong>: Identify all <code>neuroatlas</code> functions that currently accept <code>NeuroVol</code> objects as templates (e.g., for resampling targets, defining spaces).</label></li>
<li>
<label><input type="checkbox" checked><strong>T6.1.2</strong>: For each identified function, modify its signature or add a new argument to also accept:</label>
<ul><li>A TemplateFlow query string (e.g., <code>"MNI152NLin2009cAsym:1mm:brain"</code>).</li>
<li>A list of TemplateFlow query parameters (e.g., <code>list(space="MNI", resolution=1, variant="brain")</code>).</li>
</ul></li>
<li>
<label><input type="checkbox" checked><strong>T6.1.3</strong>: Implement an internal helper function <code>resolve_template_input(input)</code> that:</label>
<ul><li>Checks if <code>input</code> is already a <code>NeuroVol</code>.</li>
<li>If <code>input</code> is a string or list, parses it and calls the new <code><a href="reference/get_template.html">get_template()</a></code> to fetch the <code>NeuroVol</code>.</li>
</ul></li>
<li><label><input type="checkbox" checked><strong>T6.1.4</strong>: Update <code>get_schaefer_atlas(..., outspace)</code> so <code>outspace</code> can be a TemplateFlow query string/list, resolved via <code>resolve_template_input()</code>.</label></li>
<li><label><input type="checkbox" checked><strong>T6.1.5</strong>: Update <code>resample(vol, outspace, ...)</code> so <code>outspace</code> can be a TemplateFlow query string/list (primarily achieved by <code>get_schaefer_atlas</code> passing a resolved space).</label></li>
<li><label><input type="checkbox" checked><strong>T6.1.6</strong>: Update <code>dilate_atlas(atlas, mask, ...)</code> so <code>mask</code> can be a TemplateFlow query string/list, resolved via <code><a href="reference/dot-resolve_template_input.html">.resolve_template_input()</a></code> to fetch a brain mask.</label></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_7-documentation--vignettes">7. Documentation &amp; Vignettes<a class="anchor" aria-label="anchor" href="#id_7-documentation--vignettes"></a></h2>
<ul class="task-list"><li><label><input type="checkbox" checked><strong>T7.1.1</strong>: Write comprehensive <code>roxygen2</code> documentation for the new unified <code><a href="reference/get_template.html">get_template()</a></code> function, explaining all parameters and common use cases.</label></li>
<li><label><input type="checkbox" checked><strong>T7.1.2</strong>: Document all other new/refactored public functions (<code>create_templateflow</code>, <code>tflow_spaces</code>, <code>tflow_files</code>, <code>clear_templateflow_cache</code>, etc.).</label></li>
<li><label><input type="checkbox" checked><strong>T7.2.1</strong>: Create a new vignette: <code>vignettes/working-with-templateflow.Rmd</code>.</label></li>
<li>
<label><input type="checkbox" checked><strong>T7.2.2</strong>: Vignette content:</label>
<ul><li>Introduction to TemplateFlow concept.</li>
<li>Setting up (e.g., <code><a href="reference/create_templateflow.html">create_templateflow()</a></code>).</li>
<li>Discovering available templates/metadata (<code>tflow_spaces</code>, <code>tflow_files</code>).</li>
<li>Retrieving various template types (T1w, masks, probsegs) using <code><a href="reference/get_template.html">get_template()</a></code> and typed helpers.</li>
<li>Understanding caching behavior and management.</li>
<li>Examples of integrating TemplateFlow templates with other <code>neuroatlas</code> functions (e.g., <code>reduce_atlas</code>, plotting functions if applicable).</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_8-backward-compatibility-layer">8. Backward-Compatibility Layer<a class="anchor" aria-label="anchor" href="#id_8-backward-compatibility-layer"></a></h2>
<ul class="task-list"><li>
<label><input type="checkbox"><strong>T8.1.1</strong>: For all existing <code>get_template_*</code> functions in <code>R/template_flow.R</code> that are being replaced by the new <code><a href="reference/get_template.html">get_template()</a></code> or its wrappers:</label>
<ul><li>Mark them with <code>@deprecate new="get_template"</code> (or the relevant new helper).</li>
<li>Add <code>@keywords internal</code> if they are no longer intended for direct user invocation once deprecated.</li>
</ul></li>
<li><label><input type="checkbox"><strong>T8.1.2</strong>: Modify the body of these old functions to call the new unified <code><a href="reference/get_template.html">get_template()</a></code> or relevant new helper, ensuring parameters are correctly mapped.</label></li>
<li><label><input type="checkbox"><strong>T8.1.3</strong>: Ensure they issue a deprecation warning when called (e.g., using <code><a href="https://lifecycle.r-lib.org/reference/deprecate_soft.html" class="external-link">lifecycle::deprecate_warn()</a></code>).</label></li>
</ul></div>
<div class="section level2">
<h2 id="id_9-implementation-milestones-phased-rollout">9. Implementation Milestones (Phased Rollout)<a class="anchor" aria-label="anchor" href="#id_9-implementation-milestones-phased-rollout"></a></h2>
<div class="section level3">
<h3 id="m1-core-wrapper--foundational-retrieval">M1: Core Wrapper &amp; Foundational Retrieval<a class="anchor" aria-label="anchor" href="#m1-core-wrapper--foundational-retrieval"></a></h3>
<ul><li>Target Tickets: T1.1.1, T1.1.2, T1.1.3, T1.2.1, T2.1.1 (basic implementation), T2.1.2, T2.1.4, T3.1.1, T4.1.3.</li>
<li>Goal: Establish the <code>templateflow</code> S3 object and a working, albeit basic, <code><a href="reference/get_template.html">get_template()</a></code> that can fetch a T1w image.</li>
</ul></div>
<div class="section level3">
<h3 id="m2-full-retrieval-api--typed-helpers">M2: Full Retrieval API &amp; Typed Helpers<a class="anchor" aria-label="anchor" href="#m2-full-retrieval-api--typed-helpers"></a></h3>
<ul><li>Target Tickets: T2.1.1 (full signature), T2.1.3, T2.2.1-T2.2.8, T8.1.1-T8.1.3 (for functions being wrapped).</li>
<li>Goal: Complete the <code><a href="reference/get_template.html">get_template()</a></code> API and refactor all existing typed helpers. Implement deprecation strategy.</li>
</ul></div>
<div class="section level3">
<h3 id="m3-caching-memoisation--discoverability">M3: Caching, Memoisation &amp; Discoverability<a class="anchor" aria-label="anchor" href="#m3-caching-memoisation--discoverability"></a></h3>
<ul><li>Target Tickets: T1.2.2, T3.1.2, T3.2.1, T3.2.2, T3.3.1, T3.3.2, T5.1.1, T5.1.2, T5.1.3, T1.1.4-T1.1.6.</li>
<li>Goal: Implement robust caching and session-level memoisation. Add functions for users to explore TemplateFlow resources. Flesh out <code>templateflow</code> S3 object methods.</li>
</ul></div>
<div class="section level3">
<h3 id="m4-error-handling--validation">M4: Error Handling &amp; Validation<a class="anchor" aria-label="anchor" href="#m4-error-handling--validation"></a></h3>
<ul><li>Target Tickets: T4.1.1, T4.1.2, T4.1.4, T4.2.1, T4.2.2, T4.2.3.</li>
<li>Goal: Make the interface resilient to errors, offline scenarios, and invalid user input.</li>
</ul></div>
<div class="section level3">
<h3 id="m5-inter-package-integration">M5: Inter-package Integration<a class="anchor" aria-label="anchor" href="#m5-inter-package-integration"></a></h3>
<ul><li>Target Tickets: T6.1.1, T6.1.2, T6.1.3, T6.1.4, T6.1.5.</li>
<li>Goal: Enable seamless use of TemplateFlow resources within other <code>neuroatlas</code> functions.</li>
</ul></div>
<div class="section level3">
<h3 id="m6-documentation-vignette--final-deprecation">M6: Documentation, Vignette &amp; Final Deprecation<a class="anchor" aria-label="anchor" href="#m6-documentation-vignette--final-deprecation"></a></h3>
<ul><li>Target Tickets: T7.1.1, T7.1.2, T7.2.1, T7.2.2. Review all deprecations.</li>
<li>Goal: Provide comprehensive user guides and ensure backward compatibility story is clear.</li>
</ul></div>
<div class="section level3">
<h3 id="m7-final-review-testing--cleanup">M7: Final Review, Testing &amp; Cleanup<a class="anchor" aria-label="anchor" href="#m7-final-review-testing--cleanup"></a></h3>
<ul><li>Target Tickets: Comprehensive unit tests for all new/refactored functions. Review and remove any helper code from development (e.g. <code>.create_schaefer_alias</code> if not moved to <code>data-raw</code>). Code style checks. CRAN pre-checks.</li>
<li>Goal: Prepare for a stable release.</li>
</ul><p>This detailed ticket list should provide a clear roadmap for the refactoring effort.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

