# neuroatlas ![](reference/figures/logo.png)

**neuroatlas** provides a unified interface for working with
neuroimaging atlases and parcellations in R. Whether you’re conducting
ROI-based analyses, visualizing brain data, or integrating different
parcellation schemes, neuroatlas streamlines these tasks with
consistent, user-friendly functions.

## Features

- **Multiple Atlas Support**: Access Schaefer (100-1000 parcels),
  Glasser (360 regions), FreeSurfer ASEG, and Olsen MTL atlases
- **Flexible Resampling**: Transform atlases to different spaces and
  resolutions
- **ROI Analysis**: Extract and analyze specific regions of interest
  with [`get_roi()`](reference/get_roi.md),
  [`map_atlas()`](reference/map_atlas.md), and
  [`reduce_atlas()`](reference/reduce_atlas.md)
- **Surface & Volume**: Work with both volumetric and surface-based
  parcellations
- **TemplateFlow Integration**: Access standardized templates via the
  Python TemplateFlow API
- **Visualization**: Integration with the ggseg ecosystem for brain
  visualization

## Installation

You can install the development version from GitHub:

``` r
# install.packages("pak")
pak::pak("bbuchsbaum/neuroatlas")
```

### TemplateFlow Setup

For TemplateFlow functionality, you’ll need Python with the templateflow
package:

``` r
# After installing neuroatlas:
neuroatlas::install_templateflow()
```

## Quick Start

``` r
library(neuroatlas)

# Get a Schaefer atlas (200 parcels, 7 networks)
schaefer <- get_schaefer_atlas(parcels = 200, networks = 7)
print(schaefer)

# Extract specific ROIs
roi <- get_roi(schaefer, "DefaultA")

# Get Glasser atlas
glasser <- get_glasser_atlas()

# Access templates via TemplateFlow
mni_brain <- get_template("MNI152NLin2009cAsym", variant = "brain")
```

## Palette demos

`neuroatlas` now includes perceptually-optimised palettes for atlas
ROIs. For instance, you can generate a slice-aware palette for the
Schaefer 200×7 atlas and feed it directly into `ggseg`:

``` r
library(neuroatlas)
library(dplyr)
library(ggseg)

schaefer <- get_schaefer_atlas(parcels = 200, networks = 7)
meta <- roi_metadata(schaefer)

pal <- roi_colors_maximin_view(
  meta,
  hemi_col = "hemi",
  network_col = "network",
  pair_col = "pair_id",
  seed = 1
)

ggseg_schaefer(parcels = 200, networks = 7) +
  geom_sf(aes(fill = pal$color[match(label, pal$roi)])) +
  scale_fill_identity()
```

## Available Atlases

| Atlas | Function | Description |
|----|----|----|
| Schaefer | [`get_schaefer_atlas()`](reference/get_schaefer_atlas.md) | Cortical parcellations (100-1000 regions, 7 or 17 networks) |
| Glasser | [`get_glasser_atlas()`](reference/get_glasser_atlas.md) | 360-region multi-modal cortical parcellation |
| ASEG | [`get_aseg_atlas()`](reference/get_aseg_atlas.md) | FreeSurfer subcortical segmentation |
| Olsen MTL | [`get_olsen_mtl()`](reference/get_olsen_mtl.md) | Medial temporal lobe atlas with hippocampal subfields |

## Documentation

- [Getting
  Started](https://bbuchsbaum.github.io/neuroatlas/articles/neuroatlas-overview.html) -
  Introduction and basic usage
- [Working with
  TemplateFlow](https://bbuchsbaum.github.io/neuroatlas/articles/working-with-templateflow.html) -
  Template access and management
- [Surface
  Parcellations](https://bbuchsbaum.github.io/neuroatlas/articles/surface-parcellations.html) -
  Surface-based atlas operations
- [Function
  Reference](https://bbuchsbaum.github.io/neuroatlas/reference/index.html) -
  Complete API documentation

## Related Packages

- [neuroim2](https://github.com/bbuchsbaum/neuroim2) - Core neuroimaging
  data structures
- [neurosurf](https://github.com/bbuchsbaum/neurosurf) - Surface-based
  operations
- [ggseg](https://github.com/ggseg/ggseg) - Brain visualization

## License

MIT © Bradley Buchsbaum

## Albers theme

This package uses the albersdown theme. Existing vignette theme hooks
are replaced so `albers.css` and local `albers.js` render consistently
on CRAN and GitHub Pages. The palette family is provided via
`params$family` (default ‘red’). The pkgdown site uses
`template: { package: albersdown }`.

# Package index

## All functions

- [`MNI152_to_MNI305`](MNI152_to_MNI305.md) : MNI152 to MNI305 Affine
  Transform Matrix
- [`MNI305_to_MNI152`](MNI305_to_MNI152.md) : MNI305 to MNI152 Affine
  Transform Matrix
- [`atlas_roi_colors()`](atlas_roi_colors.md) : Assign optimal colours
  to atlas regions
- [`build_conflict_edges()`](build_conflict_edges.md) : Build
  slice-aware conflict edges between ROIs
- [`` `$`( ``*`<templateflow>`*`)`](cash-.templateflow.md) : Access
  Attributes of the TemplateFlow Object
- [`check_templateflow()`](check_templateflow.md) : Check TemplateFlow
  Installation Status
- [`clear_templateflow_cache()`](clear_templateflow_cache.md) : Clear
  neuroatlas TemplateFlow Cache
- [`coord_spaces`](coord_spaces.md) : Standard Coordinate Space
  Identifiers
- [`coordinate_spaces`](coordinate_spaces.md) : Coordinate Space
  Transforms for Neuroimaging Templates
- [`create_templateflow()`](create_templateflow.md) : Create a
  TemplateFlow Interface Object
- [`dilate_atlas()`](dilate_atlas.md) : Dilate Atlas Parcellation
  Boundaries
- [`filter_atlas()`](filter_atlas.md) : Filter Atlas by ROI Attributes
- [`fsaverage`](fsaverage.md) : Surface geometry for the fsaverage6
  atlas
- [`get_aseg_atlas()`](get_aseg_atlas.md) : Get the FreeSurfer
  Subcortical Atlas (ASEG)
- [`get_ggseg_atlas()`](get_ggseg_atlas.md) : Get ggseg-Compatible
  Schaefer Atlas
- [`get_glasser_atlas()`](get_glasser_atlas.md) : Load Glasser Atlas
- [`get_hipp_atlas()`](get_hipp_atlas.md) : Extract Hippocampal
  Parcellation
- [`get_olsen_mtl()`](get_olsen_mtl.md) : Load Olsen MTL Atlas
- [`get_roi()`](get_roi.md) : Extract a region of interest (ROI) from an
  atlas
- [`get_schaefer_atlas()`](get_schaefer_atlas.md)
  [`sy_100_7()`](get_schaefer_atlas.md)
  [`sy_100_17()`](get_schaefer_atlas.md)
  [`sy_200_7()`](get_schaefer_atlas.md)
  [`sy_200_17()`](get_schaefer_atlas.md)
  [`sy_300_7()`](get_schaefer_atlas.md)
  [`sy_300_17()`](get_schaefer_atlas.md)
  [`sy_400_7()`](get_schaefer_atlas.md)
  [`sy_400_17()`](get_schaefer_atlas.md)
  [`sy_500_7()`](get_schaefer_atlas.md)
  [`sy_500_17()`](get_schaefer_atlas.md)
  [`sy_600_7()`](get_schaefer_atlas.md)
  [`sy_600_17()`](get_schaefer_atlas.md)
  [`sy_700_7()`](get_schaefer_atlas.md)
  [`sy_700_17()`](get_schaefer_atlas.md)
  [`sy_800_7()`](get_schaefer_atlas.md)
  [`sy_800_17()`](get_schaefer_atlas.md)
  [`sy_900_7()`](get_schaefer_atlas.md)
  [`sy_900_17()`](get_schaefer_atlas.md)
  [`sy_1000_7()`](get_schaefer_atlas.md)
  [`sy_1000_17()`](get_schaefer_atlas.md) : Load Schaefer Brain
  Parcellation Atlas
- [`get_schaefer_surfatlas()`](get_schaefer_surfatlas.md) : Load
  Surface-Based Schaefer Atlas
- [`get_space_transform()`](get_space_transform.md) : Get Transform
  Matrix Between Coordinate Spaces
- [`get_subcortical_atlas()`](get_subcortical_atlas.md) : Load
  harmonized subcortical atlases via TemplateFlow
- [`get_surface_coordinate_space()`](get_surface_coordinate_space.md) :
  Get Coordinate Space for a Surface Template
- [`get_template()`](get_template.md)
  [`get_surface_template()`](get_template.md) : Fetch a Template from
  TemplateFlow
- [`ggseg_schaefer()`](ggseg_schaefer.md) : Create Interactive Schaefer
  Atlas Visualization
- [`glasser_surf()`](glasser_surf.md) : Glasser Surface Atlas
  (fsaverage)
- [`install_templateflow()`](install_templateflow.md) : Install
  Templateflow Python package
- [`load_surface_template()`](load_surface_template.md) : Load a surface
  template as a neurosurf geometry
- [`map_atlas()`](map_atlas.md) : Map values to an atlas
- [`map_to_schaefer()`](map_to_schaefer.md) : Map Values to Schaefer
  Atlas Format
- [`merge_atlases()`](merge_atlases.md) : Merge Two Brain Atlases
- [`names(`*`<templateflow>`*`)`](names.templateflow.md) : List
  Attributes of the TemplateFlow API Object
- [`needs_transform()`](needs_transform.md) : Check if Transform is
  Needed Between Spaces
- [`network_anchor_hues()`](network_anchor_hues.md) : Assign harmonic
  anchor hues to networks
- [`olsen_mtl`](olsen_mtl.md) : Olsen Medial Temporal Lobe Atlas
- [`plot(`*`<atlas>`*`)`](plot-methods.md)
  [`plot(`*`<glasser>`*`)`](plot-methods.md)
  [`plot(`*`<surfatlas>`*`)`](plot-methods.md) : Plot Glasser Atlas
- [`plot_brain()`](plot_brain.md) : Plot Brain Surface Atlas
- [`plot_glasser()`](plot_glasser.md) : Plot Glasser Atlas Values
- [`print(`*`<atlas>`*`)`](print-methods.md)
  [`print(`*`<glasser>`*`)`](print-methods.md)
  [`print(`*`<schaefer>`*`)`](print-methods.md) : Print Methods for
  neuroatlas Objects
- [`print(`*`<templateflow>`*`)`](print.templateflow.md) : Print a
  TemplateFlow Object
- [`reduce_atlas()`](reduce_atlas.md) : Reduce a NeuroVol or NeuroVec by
  an Atlas
- [`reduce_atlas_vec()`](reduce_atlas_vec.md) : Reduce a NeuroVec by an
  Atlas to a ClusteredNeuroVec
- [`resample()`](resample.md) : Resample Volume to New Space
- [`roi_attributes()`](roi_attributes.md) : List Available ROI
  Attributes
- [`roi_colors_embedding()`](roi_colors_embedding.md) : Embedding-based
  palette with smooth gradients
- [`roi_colors_maximin_view()`](roi_colors_maximin_view.md) :
  Slice-aware maximin palette for ROIs
- [`roi_colors_network_harmony()`](roi_colors_network_harmony.md) :
  Network-harmonic palette with neighbour separation
- [`roi_colors_rule_hcl()`](roi_colors_rule_hcl.md) : Deterministic HCL
  palette with harmonic variation
- [`roi_metadata()`](roi_metadata.md) : ROI Metadata Functions
- [`schaefer_surf()`](schaefer_surf.md) : Schaefer Surface Atlas
- [`schaefer_surf_options()`](schaefer_surf_options.md) : List supported
  Schaefer surface atlas variants
- [`show_templateflow_cache_path()`](show_templateflow_cache_path.md) :
  Show neuroatlas TemplateFlow Cache Path
- [`` `[[`( ``*`<templateflow>`*`)`](sub-sub-.templateflow.md) : Access
  Attributes of the TemplateFlow Object using \[\[
- [`sub_atlas()`](sub_atlas.md) : Select a Subset of Atlas Regions
- [`subcortical_atlas_options()`](subcortical_atlas_options.md) :
  Subcortical Atlas Options (TemplateFlow-backed)
- [`tflow_files()`](tflow_files.md) : Find TemplateFlow Files Matching
  Metadata Criteria
- [`tflow_spaces()`](tflow_spaces.md) : List Available TemplateFlow
  Template Spaces
- [`transform_coords()`](transform_coords.md) : Transform Coordinates
  Between Spaces
- [`transform_vertices_to_volume()`](transform_vertices_to_volume.md) :
  Transform Surface Vertices to Volume Space

# Articles

### All vignettes

- [Atlas Visualization with Optimal Colours](atlas-visualization.md):
- [Getting Started with neuroatlas](neuroatlas-overview.md):
- [Surface Parcellations with neurosurf](surface-parcellations.md):
- [Surface Templates: Geometry vs. Data](surface-templates.md):
- [Working with TemplateFlow in
  neuroatlas](working-with-templateflow.md):
